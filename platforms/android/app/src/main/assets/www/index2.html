<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
	
	<meta http-equiv="Content-Security-Policy" 
    content="default-src * 'self' 'unsafe-inline' data: gap: 'unsafe-eval';
    style-src * 'self' 'unsafe-inline'; 
    connect-src * ; 
    script-src * 'self' 'unsafe-inline'; 
    media-src *">
    <!-- Tell the browser to be responsive to screen width -->
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="format-detection" content="telephone=yes" />
    <!-- This is a wide open CSP declaration. To lock this down for production, see below. -->

	<meta http-equiv="cache-control" content="max-age=0" />
	<meta http-equiv="cache-control" content="no-cache" />
	<meta http-equiv="expires" content="0" />
	<meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
	<meta http-equiv="pragma" content="no-cache" />	
	
	
<!--	<meta http-equiv="Content-Security-Policy" content="default-src * gap:;font-src 'self' data:; style-src * 'unsafe-inline'; script-src * 'unsafe-inline' 'unsafe-eval'; media-src *; img-src * filesystem: data:">	-->

    <meta name="description" content="">
    <meta name="author" content="">
    <!-- Favicon icon -->
    <link rel="icon" type="image/png" sizes="16x16" href="assets/images/favicon.png">
    <title>Su Life - </title>
    <!-- This page CSS -->
    <!-- chartist CSS -->
    <link href="assets/node_modules/morrisjs/morris.css" rel="stylesheet">
    <!--Toaster Popup message CSS -->
    <link href="assets/node_modules/toast-master/css/jquery.toast.css" rel="stylesheet">
	<link href="assets/node_modules/calendar/dist/fullcalendar.css" rel="stylesheet" />
    <!-- Custom CSS -->
<!--    <link href="dist/css/style.min.css" rel="stylesheet">-->
    <link href="dist/css/style.css" rel="stylesheet">

    <!-- adicionado para ver se aparecem os icones no app -->
	<link href="assets/icons/font-awesome/css/font-awesome.css" rel="stylesheet">
    <link href="assets/icons/themify-icons/themify-icons.css" rel="stylesheet">

    <!-- Dashboard 1 Page CSS -->
    <link href="dist/css/pages/dashboard1.css" rel="stylesheet">
	
    <!-- page css -->
    <link href="dist/css/pages/google-vector-map.css" rel="stylesheet">	
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
    <script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

<style>
  .form-control::placeholder {
    /*color: #6c757d;*/
    color: white;
  }
.text-primary {
    color: white !important;
}  
  
</style>

</head>

<body class="skin-purple fixed-layout" style='background-color:#61233C'>
	<div class="modal fade" id="exampleModal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel1">
		<div class="modal-dialog" role="document">
			<div class="modal-content">
				<div class="modal-header">
					<h4 class="modal-title" id="exampleModalLabel1">New Activity</h4>
					<button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button>
				</div>
				<div class="modal-body">
					<form action='' name='frm' id='frm' method='post'>
						<input type='hidden' name='day' id='day' value=''>
						<input type='hidden' name='time' id='time' value=''>
						<div class="form-group">
							<label for="message-text" class="control-label">Activity:</label>
							<textarea style='color: black' name='activity' id='activity' class="form-control"></textarea>
						</div>
						<div class="form-group">
							<label for="message-text" class="control-label">Building:</label>
							<input type='text' style='color: black' name='building' id='building' class="form-control">
						</div>
						<div class="form-group">
							<label for="message-text" class="control-label">Room Number:</label>
							<input type='text' style='color: black' name='roomnumber' id='roomnumber' class="form-control">
						</div>
					</form>
				</div>
				<div class="modal-footer">
					<button type="button" class="btn btn-default" data-dismiss="modal">Close</button>
					<button type="button" onclick="addActivity(document.getElementById('day').value,document.getElementById('time').value,document.getElementById('activity').value,document.getElementById('roomnumber').value,document.getElementById('building').value)" class="btn btn-primary" data-dismiss="modal" style='color: white;background-color:#61233C'>Save</button>
				</div>
			</div>
		</div>
    </div>

    <!-- ============================================================== -->
    <!-- Preloader - style you can find in spinners.css -->
    <!-- ============================================================== -->
    <div class="preloader">
        <div class="loader">
            <div class="loader__figure"></div>
            <p class="loader__label">Su Life</p>
        </div>
    </div>
    <!-- ============================================================== -->
    <!-- Main wrapper - style you can find in pages.scss -->
    <!-- ============================================================== -->
    <div id="main-wrapper">
        <!-- ============================================================== -->
        <!-- Topbar header - style you can find in pages.scss -->
        <!-- ============================================================== -->
        <header class="topbar">
            <nav class="navbar top-navbar navbar-expand-md navbar-dark">
                <!-- ============================================================== -->
                <!-- Logo -->
                <!-- ============================================================== -->
                <div class="navbar-header">
                    <a class="navbar-brand" href="index2.html">
                        <!-- Logo icon --><b>
                            <!--You can put here icon as well // <i class="wi wi-sunset"></i> //-->
                            <!-- Dark Logo icon -->
                            <img src="assets/images/logo_fundo_branco.png" alt="homepage" class="dark-logo"  />
                            <!-- Light Logo icon -->
                            <img src="assets/images/logo_fundo_branco.png" alt="homepage" class="light-logo"  />
                        </b>
                        <!--End Logo icon -->
                        <!-- Logo text --><span>
                         <!-- dark Logo text -->
                         <img src="assets/images/logo-text.png" alt="homepage" class="dark-logo" />
                         <!-- Light Logo text -->    
                         <img src="assets/images/logo-light-text.png" class="light-logo" alt="homepage" /></span> 
					</a>					
                </div>
                <!-- ============================================================== -->
                <!-- End Logo -->
                <!-- ============================================================== -->
                <div class="navbar-collapse">
                    <!-- ============================================================== -->
                    <!-- toggle and nav items -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav mr-auto">
                        <!-- This is  -->
                        <li class="nav-item"> <a class="nav-link nav-toggler d-block d-md-none waves-effect waves-dark" href="javascript:void(0)"><i class="ti-menu"></i></a> </li>
                        <li class="nav-item"> <a class="nav-link sidebartoggler d-none d-lg-block d-md-block waves-effect waves-dark" href="javascript:void(0)"><i class="icon-menu"></i></a> </li>
                        <!-- ============================================================== -->
                        <!-- Search -->
                        <!-- ============================================================== -->
                        <li class="nav-item">
                            <form class="app-search d-none d-md-block d-lg-block">
                                <input type="text" class="form-control" placeholder="Search & enter">
                            </form>
                        </li>
                    </ul>
                    <!-- ============================================================== -->
                    <!-- User profile and search -->
                    <!-- ============================================================== -->
                    <ul class="navbar-nav my-lg-0">
                        
                        <li class="nav-item dropdown u-pro">
                            <a class="nav-link dropdown-toggle waves-effect waves-dark profile-pic" href="" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"><img id='pictureMenuUser' src="picture/user/1.jpg" alt="user" class=""> <span class="hidden-md-down"><i class="fa fa-angle-down"></i></span> </a>
                            <div class="dropdown-menu dropdown-menu-right animated flipInY">
                                <!-- text-->
                                <a onclick="getPage('settings',false)" class="dropdown-item"><i class="ti-settings"></i> Account Setting (<span id='div_name'></span>)</a>
                                <a onclick="logOff()" class="dropdown-item"><i class="fa fa-power-off"></i> Logout</a>
                                <!-- text-->
                            </div>
                        </li>
                        <!-- ============================================================== -->
                        <!-- End User Profile -->
                        <!-- ============================================================== -->
                    </ul>
                </div>
            </nav>
        </header>
        <!-- ============================================================== -->
        <!-- End Topbar header -->
        <!-- ============================================================== -->
        <!-- ============================================================== -->
        <!-- Left Sidebar - style you can find in sidebar.scss  -->
        <!-- ============================================================== -->
        <aside class="left-sidebar">
            <!-- Sidebar scroll-->
            <div class="scroll-sidebar">
                <!-- Sidebar navigation-->
                <nav class="sidebar-nav">
                    <ul id="sidebarnav">
                        <li> 
							<a class="waves-effect waves-dark" onclick="getPage('home',true)" aria-expanded="false"><i class="ti-layout-grid2"></i><span class="hide-menu">Home</span></a>
                        </li>
                        <li><a class="has-arrow waves-effect waves-dark" href="javascript:void(0)" aria-expanded="false"><i class="ti-home"></i><span class="hide-menu">Residence</span></a>
                            <ul aria-expanded="false" class="collapse">
								<li><a onclick="getPage('maintenance',true)">Maintenance</a></li>
                                <li><a onclick="getPage('followups',true)">Follow ups</a></li>
                                <li><a onclick="getPage('event',true)">Events</a></li>
                                <li><a onclick="getPage('gallery',true)">Gallery</a></li>
                                <li><a onclick="getPage('contactinfo',true)">Contact Info</a></li>
                            </ul>
						</li>
                        <li>
							<a class="waves-effect waves-dark" onclick="getPage('timetable',true)" aria-expanded="false"><i class="ti-alarm-clock"></i><span class="hide-menu">Time Table</span></a>
							<a class="waves-effect waves-dark" onclick="getPage('calendar',true)" aria-expanded="false"><i class="ti-calendar"></i><span class="hide-menu">Calendar</span></a>

							<a class="waves-effect waves-dark" href="https://learn.sun.ac.za/" aria-expanded="false"><i class="ti-link"></i><span class="hide-menu">SUNLearn</span></a>
							<a class="waves-effect waves-dark" href="https://midtier.sun.ac.za/html-navbar/home.html" aria-expanded="false"><i class="ti-link"></i><span class="hide-menu">MySun</span></a>
							
							
							<a class="waves-effect waves-dark" onclick="getPage('emergencycontact',true)" aria-expanded="false"><i class="fa fa-address-card-o"></i><span class="hide-menu">Emergency Contact</span></a>
							<a class="waves-effect waves-dark" onclick="getPage('settings',true)" aria-expanded="false"><i class="ti-settings"></i><span class="hide-menu">Settings</span></a>
							<a class="waves-effect waves-dark" onclick="logOff()" aria-expanded="false"><i class="fa fa-power-off"></i><span class="hide-menu">Log off</span></a>
                        </li>
                    </ul>
                </nav>
                <!-- End Sidebar navigation -->
            </div>
            <!-- End Sidebar scroll-->
        </aside>
		
        
        <div class="page-wrapper" id='page_index'>
            
        </div>
       
    </div>
    <script src="assets/node_modules/jquery/jquery-3.2.1.min.js"></script>
    <!-- Bootstrap popper Core JavaScript -->
    <script src="assets/node_modules/popper/popper.min.js"></script>
    <script src="assets/node_modules/bootstrap/dist/js/bootstrap.min.js"></script>
    <!-- slimscrollbar scrollbar JavaScript -->
    <script src="dist/js/perfect-scrollbar.jquery.min.js"></script>
    <!--Wave Effects -->
    <script src="dist/js/waves.js"></script>
    <!--Menu sidebar -->
    <script src="dist/js/sidebarmenu.js"></script>
    <!--Custom JavaScript -->
    <script src="dist/js/custom.js"></script>
    <!-- ============================================================== -->
    <!-- This page plugins -->
    <!-- ============================================================== -->
    <!--morris JavaScript -->
    <script src="assets/node_modules/raphael/raphael-min.js"></script>
    <script src="assets/node_modules/morrisjs/morris.min.js"></script>
    <script src="assets/node_modules/jquery-sparkline/jquery.sparkline.min.js"></script>
    <!-- Popup message jquery -->
    <script src="assets/node_modules/toast-master/js/jquery.toast.js"></script>
    <!-- Chart JS -->
    <script src="dist/js/dashboard1.js"></script>
    <script src="assets/node_modules/toast-master/js/jquery.toast.js"></script>


	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDbVmUiciv97tHYcMowlhqSoQ3au7goKHI&libraries=drawing,places"></script>
<!--	<script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDbVmUiciv97tHYcMowlhqSoQ3au7goKHI&libraries=drawing&libraries=places"></script>-->
<!--    <script src="https://maps.google.com/maps/api/js?key=AIzaSyCUBL-6KdclGJ2a_UpmB2LXvq7VOcPT7K4&sensor=true"></script>-->
    <script src="assets/node_modules/gmaps/gmaps.min.js"></script>
    <script src="assets/node_modules/gmaps/jquery.gmaps.js"></script>	

    <script src="assets/node_modules/calendar/jquery-ui.min.js"></script>
    <script src="assets/node_modules/moment/moment.js"></script>
    <script src='assets/node_modules/calendar/dist/fullcalendar.min.js'></script>
    <script src="js/cal-init.js"></script>

    <script src="assets/node_modules/calendar/jquery-ui.min.js"></script>
    <script src="assets/node_modules/moment/moment.js"></script>
    <script src='assets/node_modules/calendar/dist/fullcalendar.min.js'></script>

	<script type="text/javascript" src="cordova.js"></script>
    <script type="text/javascript" src="js/index.js"></script>
	<script type="text/javascript">

    function alertDismissed()
	{
	
	}
	let map, infoWindow;
	
	var lat=0;
	var lng=0;
	var latitude = 0;
	var longitude = 0;
	var latdest2 = 0;
	var lngdest2 = 0;
	
	
		
	function onSuccess(position) {
		lat = position.coords.latitude;
		lng = position.coords.longitude;
	}	
	
	function onError(error) {
		alert('code: '    + error.code    + '\n' +
			  'message: ' + error.message + '\n');
	}

	
	$(document).ready(function(){
		$("#page_index").load("page_index.html");
		document.getElementById('div_name').innerHTML=window.localStorage.getItem("name");
		document.getElementById('pictureMenuUser').src='https://www.tempustecnologia.com/sulife/picture/user/'+window.localStorage.getItem("picture");
		if (window.localStorage.getItem("iduser")=='25')
		{
			// brasil
			latdest2 = -22.9632695;
			lngdest2 = -43.3957459;
		}
		else
		{
			// africa do sul
			latdest2 = -33.9328078;
			lngdest2 = 18.864447;
		}
		
		navigator.geolocation.getCurrentPosition(onSuccess, onError);		
	});	
	
	
		function logOff()
		{
	
			$.post("https://tempustecnologia.com/sulife/controller/exec.register.php",
			{
			  op: "LOGOFF",
			  iduser:  window.localStorage.getItem("iduser")
			},
			function(data,status){
				if (status=='success')
				{
					window.location.href = "index.html";
				}
			});
		}	
	
	
	//
	// botao excluir imagem manutenção
	//
	function excluirImagemManutencao(arquivo)
	{
		navigator.notification.confirm(
			'Are you sure you want to delete ',  // message
			onConfirmDeleteImagemMantenance,              // callback to invoke with index of button pressed
			'Delete',            // title
			 ['yes','no']             // buttonLabels
		);

		function onConfirmDeleteImagemMantenance(buttonIndex)
		{
			if(buttonIndex==2)
			{

			}
			else
			{	
				$.post("https://tempustecnologia.com/sulife/controller/exec.maintenance.php",
				{
				  op: "EARQUIVOAPP",
				  arquivo:  arquivo
				},
				function(data,status){
					if (data.trim()=='OK')
					{
						navigator.notification.alert(
								'Deleted successfully.',  // message
								alertDismissed,         // callback
								'Success',            // title
								'OK'                  // buttonName
						);
						getPage('followups',false)
					}
					else
					{
						navigator.notification.alert(
								'Unable to delete.',  // message
								alertDismissed,         // callback
								'error',            // title
								'OK'                  // buttonName
						);				
					}
				});
			}
		}
	}
	
	//
	// botão excluir manutenção clicado em folowups
	//
	
	function excluirManutencao(id)
	{
		navigator.notification.confirm(
			'Are you sure you want to delete ',  // message
			onConfirmDeleteMantenance,              // callback to invoke with index of button pressed
			'Delete',            // title
			 ['yes','no']             // buttonLabels
		);

		function onConfirmDeleteMantenance(buttonIndex)
		{
			if(buttonIndex==2)
			{

			}
			else
			{	
	
	
				$.post("https://tempustecnologia.com/sulife/controller/exec.maintenance.php",
				{
				  op: "EAPP",
				  idmaintenance:  id
				},
				function(data,status){
					if (data.trim()=='OK')
					{
						navigator.notification.alert(
								'Deleted successfully.',  // message
								alertDismissed,         // callback
								'Success',            // title
								'OK'                  // buttonName
						);
						getPage('followups',false)
					}
					else
					{
						navigator.notification.alert(
								'Unable to delete.',  // message
								alertDismissed,         // callback
								'error',            // title
								'OK'                  // buttonName
						);				
					}
				});
			}
		}
	}
	
	//
	// botão register em NEW EMERGENCY CONTACT
	//
	function addEmergencyContact()
	{
		if (
			(document.getElementById('edtname').value!='') && 
			(document.getElementById('edtphonenumber').value!='')
		)
		{

		$.post("https://tempustecnologia.com/sulife/controller/exec.emergencycontact.php",
		{
		  op: "IAPP",
		  iduser:  window.localStorage.getItem("iduser"),
		  edtname: document.getElementById('edtname').value,
		  edtsurname: document.getElementById('edtsurname').value,
		  edtphonenumber: document.getElementById('edtphonenumber').value,
		  edtrelationship: document.getElementById('edtrelationship').value,
		  edtemail: document.getElementById('edtemail').value
		},
		function(data,status){
			if (data.trim()=='OK')
			{
				navigator.notification.alert(
						'Added successfully.',  // message
						alertDismissed,         // callback
						'Success',            // title
						'OK'                  // buttonName
				);
				getPage('emergencycontact',false)				
			}
			else
			{
				navigator.notification.alert(
						'Unable to add.',  // message
						alertDismissed,         // callback
						'error',            // title
						'OK'                  // buttonName
				);				
			}
		});
		}
		else
		{
			navigator.notification.alert(
							'Fill in the fields.',  // message
							alertDismissed,         // callback
							'Warning',            // title
							'OK'                  // buttonName
			);		
		}		
		
		
	};

	//
	// botão ADICIONAR NOVA MANUTENÇÃO
	//
	
	function addMantenance()
	{
		if (
			(document.getElementById('edtdescription').value!='') && 
			(document.getElementById('edtdescription').value!='')
		)
		{
	
			$.post("https://tempustecnologia.com/sulife/controller/exec.maintenance.php",
			{
			  op: "IAPP",
			  iduser:  window.localStorage.getItem("iduser"),
			  edtdescription: document.getElementById('edtdescription').value,
			  edttags: document.getElementById('edttags').value
			},
			function(data,status){
				//alert(data);
				if (data.trim()=='OK')
				{
					navigator.notification.alert(
							'Added successfully.',  // message
							alertDismissed,         // callback
							'Success',            // title
							'OK'                  // buttonName
					);
					getPage('followups',false);
				}
				else
				{
					navigator.notification.alert(
							'Unable to add.',  // message
							alertDismissed,         // callback
							'error',            // title
							'OK'                  // buttonName
					);				
				}
			});
		}
		else
		{
			navigator.notification.alert(
							'Fill in the fields.',  // message
							alertDismissed,         // callback
							'Warning',            // title
							'OK'                  // buttonName
			);		
		}
	};
	
	//
	// botão ATUALIZAR CONTA USUARIO
	//
	
	
	function updateSetttings()
	{
		//alert(document.getElementById('edtpictureuser').value);
		if (
					(document.getElementById('edtname').value!='') &&
					(document.getElementById('edtsurname').value!='') &&
					(document.getElementById('edtphonenumber').value!='') &&
					(document.getElementById('cmboxresidence').value!='') &&
					(document.getElementById('edtgender').value!='')
			)
			{	
	
		$.post("https://tempustecnologia.com/sulife/controller/exec.register.php",
		{
		  op: "AAPP",
		  iduser: window.localStorage.getItem("iduser"),
		  edtname: document.getElementById('edtname').value,
		  edtsurname: document.getElementById('edtsurname').value,
		  edtphonenumber: document.getElementById('edtphonenumber').value,
		  cmboxresidence: document.getElementById('cmboxresidence').value,
		  edtgender: document.getElementById('edtgender').value,
		  picture: document.getElementById('edtpictureuser').value
		},
		function(data,status){
			if (data.trim()=='OK')
			{
				navigator.notification.alert(
						'Successfully changed.',  // message
						alertDismissed,         // callback
						'Success',            // title
						'OK'                  // buttonName
				);	
			}
			else
			{
				navigator.notification.alert(
						'Could not change.',  // message
						alertDismissed,         // callback
						'error',            // title
						'OK'                  // buttonName
				);	
			}
		});
	}
	else
	{
				navigator.notification.alert(
							'Check the fields. All fields are mandatory',  // message
							alertDismissed,         // callback
							'Warning',            // title
							'OK'                  // buttonName
						);	
			
			}
	}

	
	function handleLocationError(browserHasGeolocation, infoWindow, pos) {
		  infoWindow.setPosition(pos);
		  infoWindow.setContent(
			browserHasGeolocation
			  ? "Error: The Geolocation service failed."
			  : "Error: Your browser doesn't support geolocation."
		  );
		infoWindow.open(map);
	}
	
	
	//
	// MOSTRAR GALERIA 
	//
	
	function getGalery()
	{
		$.post("https://tempustecnologia.com/sulife/controller/exec.gallery.php",
		{
		  op: "LISTAPP",
		  iduser: window.localStorage.getItem("name")
		},
		function(data,status){
			$("#div_gallery").html(data); 
		});
	}

	//
	// MOSTRAR FOTOS DE UMA GALERIA 
	//

	
	function getGaleryPicture(idgallery)
	{
		$.post("https://tempustecnologia.com/sulife/controller/exec.gallery.php",
		{
		  op: "LISTPICTURES",
		  idgallery: idgallery
		},
		function(data,status){
			$("#div_gallery_pictures").html(data); 
		});
	}

	//
	// MOSTRAR CONTATO DA RESIDENCIA 
	//

	
	function getResidenceContactInfo()
	{
		$.post("https://tempustecnologia.com/sulife/view/residencecontactinfo.php",
		{
		  op: "C",
		  idresidence: window.localStorage.getItem("idresidence")
		},
		function(data,status){
			$("#div_residencecontactinfor").html(data); 
		});
	}

	//
	// MOSTRAR MANUTENÇÃO 
	//
	
	
	function getMaintenance()
	{
		$.post("https://tempustecnologia.com/sulife/view/followups.php",
		{
		  op: "C",
		  iduser: window.localStorage.getItem("iduser")
		},
		function(data,status){
			$("#div_listamaintenance").html(data); 
		});
	}

	//
	// MOSTRAR CONTATOS DE EMERGENCIA 
	//

	
	function getEmergencyContact()
	{
		$.post("https://tempustecnologia.com/sulife/view/emergencycontact.php",
		{
		  op: "C",
		  iduser: window.localStorage.getItem("iduser")
		},
		function(data,status){
			$("#div_listaemergencycontact").html(data); 
		});
	}
	
	//
	// MOSTRAR EVENTOS 
	//
	
	
	function getEvent()
	{
		$.post("https://tempustecnologia.com/sulife/controller/exec.event.php",
		{
		  op: "LISTAPP",
		  iduser: window.localStorage.getItem("iduser")
		},
		function(data,status){
			$("#div_event").html(data); 
		});
	}

	//
	// EXCLUIR CONTATO DE EMERGENCIA 
	//

	
	function deleteEmergencyContact(id)
	{
		navigator.notification.confirm(
			'Are you sure you want to delete ',  // message
			onConfirmDeleteEmergencyContact,              // callback to invoke with index of button pressed
			'Delete',            // title
			 ['yes','no']             // buttonLabels
		);

		function onConfirmDeleteEmergencyContact(buttonIndex)
		{
			if(buttonIndex==2)
			{

			}
			else
			{
				$.post("https://tempustecnologia.com/sulife/controller/exec.emergencycontact.php",
				{
				  op: "E",
				  idemergencycontact: id
				},
				function(data,status){
					if (data.trim()=='OK')
					{
						navigator.notification.alert(
							'Successfully deleted.',  // message
							alertDismissed,         // callback
							'Success',            // title
							'OK'                  // buttonName
						);
						getPage('emergencycontact',false);
						
					}
					else
					{
						navigator.notification.alert(
						'Could not delete.',  // message
								alertDismissed,         // callback
								'Warning',            // title
								'OK'                  // buttonName
						);	
					}
				});
			}
		}
	}


	//
	// FECHAR MENU 
	//
	
	function fechaMenu(closemenu)
	{
		if (closemenu)
		{
			$("body").toggleClass("show-sidebar");
			$(".nav-toggler i").toggleClass("ti-menu");
			$(".nav-toggler i").addClass("ti-close");
		}
	}

	//
	// CARREGA PÁGINAS 
	//

	
	function getPage(p,closemenu,valor)
	{


		if (p=='home')
		{
			$("#page_index").load("page_index.html", function( response, status, xhr ) {
				fechaMenu(closemenu);
				if ( status == "error" ) {
					var msg = "Sorry but there was an error: ";
					$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
				}
				if (status == "success")
				{
				
				}
			});
		}
		if (p=='minhaposicao')
		{
			$("#page_index").load("page_minhaposicao.html", function( response, status, xhr ) {
			  if ( status == "error" ) {
				var msg = "Sorry but there was an error: ";
				$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
			  }
			  if (status == "success")
			  {
					map = new google.maps.Map(document.getElementById("gmaps-simple"), {
						center: { lat: lat, lng: lng },
						zoom: 15
					});
					//const image =
					//"https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png";
					const beachMarker = new google.maps.Marker({
					position: { lat: lat, lng: lng },
					map
				  });
				  
				  const outerCoords = [
					{ lat: -33.930931, lng: 18.866530 },
					{ lat: -33.930865, lng: 18.867105 },
					{ lat: -33.931143, lng: 18.867131 },
					{ lat: -33.931214, lng: 18.866592 } // north east
				  ];
				  
				  const outerCoords2 = [
				  { lat: -33.931580, lng: 18.866724},
				  { lat: -33.931483, lng: 18.867573},
				  { lat: -33.932576, lng: 18.867752},
				  { lat: -33.932571, lng: 18.867559},
				  { lat: -33.932285, lng: 18.867492},
				  { lat: -33.932350, lng: 18.867015},
				  { lat: -33.932610, lng: 18.867052},
				  { lat: -33.932619, lng: 18.866872}
				  ];
				  
				  // Define the LatLng coordinates for an inner path.
				  const security = new google.maps.Polygon({
					paths: outerCoords,
					strokeColor: "#FF0000",
					strokeOpacity: 0.8,
					strokeWeight: 2,
					fillColor: "#FF0000",
					fillOpacity: 0.35
				  });  
				  
				  security.setMap(map);
				  
				  const mike = new google.maps.Polygon({
					paths: outerCoords2,
					strokeColor: "#0000FF",
					strokeOpacity: 0.8,
					strokeWeight: 2,
					fillColor: "#FF0000",
					fillOpacity: 0.35
				  }); 
				  
				  mike.setMap(map);

					google.maps.event.addListener(security, 'click', function (event) {
						alert("Campus Security");
					});
					
					google.maps.event.addListener(mike, 'click', function (event) {
						alert("Mike de Vries\nChemistry - First-years\nInoganic Chemistry\nCGW Shumann");
					});
					
				}
			}
			);  
		}

		
		if (p=='track')
		{
			$("#page_index").load("page_track.html", function( response, status, xhr ) {
			  if ( status == "error" ) {
				var msg = "Sorry but there was an error: ";
				$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
			  }
			  if (status == "success")
			  {
					map = new google.maps.Map(document.getElementById("gmaps-simple"), {
						center: { lat: lat, lng: lng },
						zoom: 15
					});
					
					const directionsRenderer = new google.maps.DirectionsRenderer();
					const directionsService = new google.maps.DirectionsService();
					directionsRenderer.setMap(map);
					calculateAndDisplayRoute(directionsService, directionsRenderer);
					
					  //directionsRenderer.setPanel(document.getElementById("right-panel<?php echo $idpanic;?>"));

					  function calculateAndDisplayRoute(directionsService, directionsRenderer) {
					  const selectedMode = 'WALKING';//document.getElementById("mode").value;
					  
					  
					  
					  directionsService.route(
						{
							
						  destination: { lat: latdest2, lng: lngdest2 },
						  origin: { lat: lat, lng: lng },
						  // Note that Javascript allows us to access the constant
						  // using square brackets and a string value as its
						  // "property."
						  // @ts-ignore
						  travelMode: google.maps.TravelMode['WALKING']
						},
						(response, status) => {
						  if (status == "OK") {
							directionsRenderer.setDirections(response);
						  } else {
							window.alert("Directions request failed due to " + status);
						  }
						}
					  );
					}
					
					
					//const image =
					//"https://developers.google.com/maps/documentation/javascript/examples/full/images/beachflag.png";
					/*const beachMarker = new google.maps.Marker({
					position: { lat: lat, lng: lng },
					map
				  });
				  */
					
				}
			}
			);  
		}		

		
		if (p=='map')
		{
			var busca = document.getElementById('edtsearch').value;
			$("#page_index").load("page_maps.html", function( response, status, xhr ) {
			  if ( status == "error" ) {
				var msg = "Sorry but there was an error: ";
				$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
			  }
			  if (status == "success")
			  {
				map = new google.maps.Map(document.getElementById("gmaps-simple"), {
					center: { lat: -33.9329023, lng: 18.8569261 },
					zoom: 15
				});
				
				
const outerCoords = [
					{ lat: -33.930931, lng: 18.866530 },
					{ lat: -33.930865, lng: 18.867105 },
					{ lat: -33.931143, lng: 18.867131 },
					{ lat: -33.931214, lng: 18.866592 } // north east
				  ];
				  
				  const outerCoords2 = [
				  { lat: -33.931580, lng: 18.866724},
				  { lat: -33.931483, lng: 18.867573},
				  { lat: -33.932576, lng: 18.867752},
				  { lat: -33.932571, lng: 18.867559},
				  { lat: -33.932285, lng: 18.867492},
				  { lat: -33.932350, lng: 18.867015},
				  { lat: -33.932610, lng: 18.867052},
				  { lat: -33.932619, lng: 18.866872}
				  ];
				  
				  // Define the LatLng coordinates for an inner path.
				  const security = new google.maps.Polygon({
					paths: outerCoords,
					strokeColor: "#FF0000",
					strokeOpacity: 0.8,
					strokeWeight: 2,
					fillColor: "#FF0000",
					fillOpacity: 0.35
				  });  
				  
				  security.setMap(map);
				  
				  const mike = new google.maps.Polygon({
					paths: outerCoords2,
					strokeColor: "#0000FF",
					strokeOpacity: 0.8,
					strokeWeight: 2,
					fillColor: "#FF0000",
					fillOpacity: 0.35
				  }); 
				  
				  mike.setMap(map);

					google.maps.event.addListener(security, 'click', function (event) {
						alert("Campus Security");
					});
					
					google.maps.event.addListener(mike, 'click', function (event) {
						alert("Mike de Vries\nChemistry - First-years\nInoganic Chemistry\nCGW Shumann");
					});				
  
  
				  const input = document.getElementById("pac-input");
				  input.value=busca;
				  const searchBox = new google.maps.places.SearchBox(input);
				  map.controls[google.maps.ControlPosition.LEFT_TOP].push(input);
				  // Bias the SearchBox results towards current map's viewport.
				  map.addListener("bounds_changed", () => {
					searchBox.setBounds(map.getBounds());
				  });
		  
				let markers = [];
				  // Listen for the event fired when the user selects a prediction and retrieve
				  // more details for that place.
				searchBox.addListener("places_changed", () => {
				const places = searchBox.getPlaces();

				if (places.length == 0) {
				  return;
				}
				// Clear out the old markers.
				markers.forEach(marker => {
				  marker.setMap(null);
				});
				markers = [];
				// For each place, get the icon, name and location.
				const bounds = new google.maps.LatLngBounds();
				places.forEach(place => {
				  if (!place.geometry) {
					console.log("Returned place contains no geometry");
					return;
				  }
				  const icon = {
					url: place.icon,
					size: new google.maps.Size(71, 71),
					origin: new google.maps.Point(0, 0),
					anchor: new google.maps.Point(17, 34),
					scaledSize: new google.maps.Size(25, 25)
				  };
				  // Create a marker for each place.
				  markers.push(
					new google.maps.Marker({
					  map,
					  icon,
					  title: place.name,
					  position: place.geometry.location
					})
					);

				  if (place.geometry.viewport) {
					// Only geocodes have viewport.
					bounds.union(place.geometry.viewport);
				  } else {
					bounds.extend(place.geometry.location);
				  }
				});
				
				// criar o ponto onde eu estou
								  // Create a marker for each place.
				  markers.push(
					new google.maps.Marker({
					  map,
					  title: 'Me',
					  position: { lat: -33.9329023, lng: 18.8569261 }
					})
					);
				
				
				map.fitBounds(bounds);
				input.focus();
			});  
  
  
			/*  infoWindow = new google.maps.InfoWindow();
						map = new GMaps({
							el: '#gmaps-simple',
							lat: -33.9329023,
							lng: 18.8569261,
							zoom : 10,
							panControl : false,
							streetViewControl : true,
							mapTypeControl: true,
							overviewMapControl: false
						  });
						   map.addMarker({
							lat: -33.9329023,
							lng: 18.8569261,
							title: 'Marker with InfoWindow',
							infoWindow: {
							  content: '<p>Your Content</p>'
							}
						  });  
			*/			  
			infoWindow = new google.maps.InfoWindow();

			  // Try HTML5 geolocation.
			  if (navigator.geolocation) {
				navigator.geolocation.getCurrentPosition(
				  position => {
					const pos = {
					  lat: position.coords.latitude,
					  lng: position.coords.longitude
					};
					map.setCenter(pos);
					map.addMarker({
							lat: position.coords.latitude,
							lng: position.coords.longitude,
							title: 'My Position',
							infoWindow: {
							  content: '<p>My Position</p>'
							}
						  }); 
				  },
				  () => {
					handleLocationError(true, infoWindow, map.getCenter());
				  }
				  
				);
				
				
				
			  } else {
				// Browser doesn't support Geolocation
				handleLocationError(false, infoWindow, map.getCenter());
			  }			  
						  
			  
			  
			  
			  } 
			});

/*			 map = new GMaps({
				el: '#gmaps-simple',
				lat: -33.9329023,
				lng: 18.8569261,
				zoom : 10,
				panControl : false,
				streetViewControl : true,
				mapTypeControl: true,
				overviewMapControl: false
			  });
			   map.addMarker({
				lat: -33.9329023,
				lng: 18.8569261,
				title: 'Marker with InfoWindow',
				infoWindow: {
				  content: '<p>Your Content</p>'
				}
			  });
			  */
			//fechaMenu();
		}
		if (p=='contactinfo')
		{
			$("#page_index").load("page_contactinfo.html");
			getResidenceContactInfo();
			fechaMenu(closemenu);
		}
		if (p=='gallery')
		{
			$("#page_index").load("page_gallery.html");
			fechaMenu(closemenu);
			getGalery();
		}
		if (p=='gallery_pictures')
		{
			$("#page_index").load("page_gallery_pictures.html");
			fechaMenu(closemenu);
			getGaleryPicture(valor);
		}
		if (p=='event')
		{
			$("#page_index").load("page_event.html");
			fechaMenu(closemenu);
			getEvent();
		}
		if (p=='followups')
		{
			$("#page_index").load("page_followups.html", function( response, status, xhr ) {
				fechaMenu(closemenu);
				if ( status == "error" ) {
					var msg = "Sorry but there was an error: ";
					$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
				}
				if (status == "success")
				{
					getMaintenance()
				}
			});
			
			
		}
		if (p=='maintenance')
		{
			$("#page_index").load("page_maintenance.html");
			fechaMenu(closemenu);
		}
		if (p=='settings')
		{
			$("#page_index").load("page_settings.html", function( response, status, xhr ) {
				fechaMenu(closemenu);
				if ( status == "error" ) {
					var msg = "Sorry but there was an error: ";
					$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
				}
				if (status == "success")
				{
					$.post("https://tempustecnologia.com/sulife/controller/exec.residence.php",
					{
						op: "LISTAPP",
						idresidence: window.localStorage.getItem("idresidence").trim()
					},
					function(data,status){
						$("#div_residence").html(data); 
						document.getElementById('cmboxresidence').value=window.localStorage.getItem("idresidence").trim();
					});

					document.getElementById('edtname').value=window.localStorage.getItem("name");
					document.getElementById('edtsurname').value=window.localStorage.getItem("surname");
					document.getElementById('edtphonenumber').value=window.localStorage.getItem("phonenumber");
					document.getElementById('edtgender').value=window.localStorage.getItem("gender").trim();
					document.getElementById('edtpictureuser').value=window.localStorage.getItem("picture").trim();
					document.getElementById('img_user').src='https://www.tempustecnologia.com/sulife/picture/user/'+window.localStorage.getItem("picture");
					
				}
			});
		}		
		if (p=='emergencycontact')
		{
			$("#page_index").load("page_emergencycontact.html", function( response, status, xhr ) {
				fechaMenu(closemenu);
				if ( status == "error" ) {
					var msg = "Sorry but there was an error: ";
					$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
				}
				if (status == "success")
				{
					getEmergencyContact();
				}
			});
		}
		
		if (p=='timetable')
		{
			$("#page_index").load("page_timetable.html", function( response, status, xhr ) {
				fechaMenu(closemenu);
				if ( status == "error" ) {
					var msg = "Sorry but there was an error: ";
					$( "#error" ).html( msg + xhr.status + " " + xhr.statusText );
				}
				if (status == "success")
				{
					getTimetable();//alert('OK');
				}
			});
		}
		
		if (p=='calendar')
		{
			$("#page_index").load("page_calendar.html");
			fechaMenu(closemenu);
		}


		if (p=='newemergencycontact')
		{
			$("#page_index").load("page_newemergencycontact.html");
		}
	}
		
		var seconds = 6;
		var panic = false;
		
		var element =  document.getElementById('btncounter');
		if (typeof(element) != 'undefined')
		{
			// Exists.
			//cancel = setInterval(decrementSeconds, 1000);
		}
		

		function restoreState()
		{
			seconds = 6;
			panic = false;
			document.getElementById("btncounter").style.background = "#61233C";
			document.getElementById("btncounter").innerHTML = "PANIC";
			document.getElementById('seconds-counter').innerText = "";
			clearInterval(cancel);
		}
		
		
		function start()
		{
			panic = !panic;
			if (panic==false)
			{
				clearInterval(cancel);
				restoreState();
				document.getElementById('div_alert_panic').innerHTML = '';
				$("#loginform").css("display", "block");
				$("#div_panic_btn").css("display", "none");
			}
			else
			{
				$("#div_panic_btn").css("display", "block");
				$("#loginform").css("display", "none");
				cancel = setInterval(decrementSeconds, 1000);
				document.getElementById("btncounter").innerHTML = "CANCEL";
				document.getElementById("btncounter").style.background = "green";
				 $("#div_loginbox").css({ 'background-color': '#ffffff' });
				 $("#div_loginbox").css('background-image', 'none');
				//document.getElementById("btncounter").className = "btn btn-info btn-lg btn-block text-uppercase btn-rounded";
				//cancel = setInterval(incrementSeconds, 1000);
				decrementSeconds();
			}
		}
		
		
		function decrementSeconds() {
			//var el = document.getElementById('seconds-counter');
			if (panic==true)
			{
				seconds -= 1;
			}
			else
			{
				seconds = 6;
			}
			//el.innerText = "You have been here for " + seconds + " seconds.";
			if (seconds<6)
			{
				document.getElementById('seconds-counter').innerHTML = " "+ seconds + "<br><br><br>";
			}
			else
			{
				document.getElementById('seconds-counter').innerHTML = '';
			}
			if (seconds<0)
			{
				//var lat=0;
				//var lng=0;
				
				
				$.post("https://tempustecnologia.com/sulife/controller/exec.panic.php",
				{
				  op: "IAPP",
				  iduser: window.localStorage.getItem("iduser"),
				  lat: lat,
				  lng: lng
				},
				function(data,status){
					
					if (data.trim()!='OK')
					{
						document.getElementById('div_alert_panic').innerHTML = '<div class="alert alert-warning"><button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">×</span> </button><h3 class="text-warning"><i class="fa fa-check-circle"></i> Warning</h3> Campus Security has NOT been notified.</div>';
						
					}
					else
					{
						document.getElementById('div_alert_panic').innerHTML = '<div class="alert alert-success"><button type="button" class="close" data-dismiss="alert" aria-label="Close"> <span aria-hidden="true">×</span> </button><h3 class="text-success"><i class="fa fa-check-circle"></i> Success</h3> Campus Security has been notified.</div>';
						//alert('Enviar para o siga-me');
						getLocation();
						getContacts();
					}
					
				});							
				restoreState();
			}
		}

	var watchID = '';


	
	function getLocation() {
	  if (navigator.geolocation) {
		watchID = navigator.geolocation.watchPosition(showPosition);
	  } else {
		alert("Geolocation is not supported by this browser.");
	  }
	}
	
	function showPosition(position) {
		$("#loginform").css("display", "none");
		$("#div_loginbox").css({ 'background-color': '#ffffff' });
		$("#div_loginbox").css('background-image', 'none');
	
		$.post("https://tempustecnologia.com/sulife/controller/exec.panic.php",
		{
		  op: "UPATEAPP",
		  iduser: window.localStorage.getItem("iduser"),
		  lat: position.coords.latitude,
		  lng: position.coords.longitude
		},
		function(data,status){
			//alert(data);
			if (data.trim()!='OK')
			{
				document.getElementById('div_alert_panic').innerHTML = '<div class="alert alert-warning"><h3 class="text-warning"><i class="fa fa-check-circle"></i> Warning</h3> Não foi possível atualizar a coordenada.</div>';
				navigator.geolocation.clearWatch(watchID);
			}
			else
			{
				var d = new Date(); 
				var date=""+d.getFullYear()+"-"+d.getMonth()+"-"+d.getDate()+" "+d.getMinutes()+':'+d.getSeconds();
				document.getElementById('div_alert_panic').innerHTML = '<div class="alert alert-success"><h3 class="text-success"><i class="fa fa-check-circle"></i> <a onclick="getPage(\'minhaposicao\',false)">Success</a></h3> Coordenada atualizada. Lat:'+position.coords.latitude+' Lng:'+position.coords.longitude+' em '+date+'</div>';
			}
		});		
		//alert("Latitude: " + position.coords.latitude +
		//"<br>Longitude: " + position.coords.longitude);
		//document.getElementById('div_alert_panic').innerHTML = '<div class="alert alert-success"><h3 class="text-success"><i class="fa fa-check-circle"></i> Success</h3> Coordenada atualizada. Lat:'+position.coords.latitude+' Lng:'+position.coords.longitude+'</div>';
		getPanicStatus();
	}	
	
	function getPanicStatus()
	{
		$.post("https://tempustecnologia.com/sulife/controller/exec.panic.php",
		{
		  op: "STATUSPANIC",
		  iduser: window.localStorage.getItem("iduser")
		},
		function(data,status){
			
			$("#div_alert_panic_security").html(data); 
		});
	}
		
	function abreCamera(tipo,funcao,id)
	{
    	getImage(tipo,funcao,id);
		getPage('followups',false)
	}

	var id_ ;
	
	
	// video
	function pegaVideo(id)
	{
		navigator.notification.alert(
			'This function is not allowed yet.',  // message
			alertDismissed,         // callback
			'Warning',            // title
			'OK'                  // buttonName
		);		
	
	}
	
	// audio
	function pegaAudio(id)
	{
		navigator.notification.alert(
			'This function is not allowed yet.',  // message
			alertDismissed,         // callback
			'Warning',            // title
			'OK'                  // buttonName
		);	
	}
	
	// fotografia
	function getImage(tipo,funcao,id)
	{
		id_ = id;
		//alert('tipo:'+tipo);
		//alert('funcao:'+funcao);
		//alert('id:'+id);
		//alert('id_:'+id_);
		if (tipo=='CAMERA')
		{
			if (funcao=='PEDIDO')
			{
				navigator.camera.getPicture(uploadPhoto, function(message) {
					alert('get picture failed');
				}, {
				quality: 25,
				destinationType: navigator.camera.DestinationType.FILE_URI,
				sourceType: navigator.camera.PictureSourceType.CAMERA
			 });
			 // navigator.camera.DestinationType.FILE_URI
			}
			else
			{
				navigator.camera.getPicture(uploadPhoto, function(message) {
					alert('get picture failed');
				}, {
				quality: 25,
				destinationType: navigator.camera.DestinationType.FILE_URI,
				sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY

				});
//				destinationType: navigator.camera.DestinationType.FILE_URI,
			//sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
				
			}
		}
		else
		{
			navigator.camera.getPicture(uploadPhoto, function(message) {
				alert('get picture failed'+message);
			}, {
			quality: 50,
			destinationType: navigator.camera.DestinationType.FILE_URI,
			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY
			});
			//			destinationType: navigator.camera.DestinationType.FILE_URI,
			//			sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY

			
		}
		
	}
	

	function leftPad(value, totalWidth, paddingChar) {
		var length = totalWidth - value.toString().length + 1;
		return Array(length).join(paddingChar || '0') + value;
	};
		 	
	function uploadPhoto(imageURI) {
		
		//alert(imageURI.substr(imageURI.lastIndexOf('/') + 1));
		var options = new FileUploadOptions();
		options.fileKey = "file";
		options.fileName = leftPad(id_,5)+'_'+imageURI.substr(imageURI.lastIndexOf('/') + 1);
		//options.fileName = imageURI.substr(imageURI.lastIndexOf('/') + 1);
		options.mimeType = "image/jpeg";
		console.log(options.fileName);
		var params = new Object();
		params.value1 = "test";
		params.value2 = "param";
		options.params = params;
		options.chunkedMode = false;

		var ft = new FileTransfer();
		ft.onprogress = function(progressEvent) {
			//alert(progressEvent.loaded);
			var p =  Math.round((progressEvent.loaded / progressEvent.total)*100);
			
			var progress = '';
			progress = '<div class="progress">';
			progress +='<div class="progress-bar bg-success" role="progressbar" style="width: '+p+'%;height:15px;" role="progressbar"> '+p+'% </div>';
			progress +='</div>';
			document.getElementById('progressbarfollowups').innerHTML = progress;
			
			//document.getElementById('btn_camera_'+document.getElementById('idpedidoparaatendimento').value+'').value = progressEvent.loaded;
			
			//if (progressEvent.lengthComputable) {
		//		loadingStatus.setPercentage(progressEvent.loaded / progressEvent.total)*100;
		//	} else {
		//		loadingStatus.increment();
		//	}
			
		};
		//alert('imageURI:'+imageURI);
		ft.upload(imageURI, "https://www.tempustecnologia.com/sulife/upload.php", function(result){
				//alert('3');

				navigator.notification.alert(
									'Image uploaded successfully.',  // message
									alertDismissed,         // callback
									'Atenção',            // title
									'OK'                  // buttonName
				);
				
				getPage('followups',false);
				console.log(JSON.stringify(result));
		}, function(error){
				//alert(JSON.stringify(error));
				navigator.notification.alert(
									'Could not upload the image.',  // message
									alertDismissed,         // callback
									'Atenção',            // title
									'OK'                  // buttonName
				);
			console.log(JSON.stringify(error));
		}, options);
		
		
	}	

function getContacts()
{
	$.post("https://tempustecnologia.com/sulife/controller/exec.emergencycontact.php",
	{
	  op: "LIST",
	  iduser: window.localStorage.getItem("iduser")
	},
	function(data,status){
		$("#div_alert_panic_contact").html(data); 
	});
}
	
	
// time table

function getTimetable()
{
	$.post("https://tempustecnologia.com/sulife/controller/exec.timetable.php",
	{
	  op: "LISTAPP",
	  iduser: window.localStorage.getItem("iduser")
	},
	function(data,status){
		$("#div_timetable").html(data); 
	});
}

function abreModal(dia,hora,atividade,roomnumber,building)
{
	document.getElementById('day').value=dia;
	document.getElementById('time').value=hora;
	document.getElementById('activity').value=atividade;
	document.getElementById('roomnumber').value=roomnumber;
	document.getElementById('building').value=building;
	$('#exampleModal').modal();
}

function addActivity(dia,hora,activity,roomnumber,building)
{

if ( activity!='')
	{	

	//alert('dia:'+dia+' hora:'+hora+' Atividade:'+activity);
	$.post("https://tempustecnologia.com/sulife/controller/exec.timetable.php",
	{
		op: "IAPP",
		iduser: window.localStorage.getItem("iduser"),
		day: dia,
		time: hora,
		activity: activity,
		roomnumber: roomnumber,
		building: building
	},
	function(data,status){
		if (data.trim()=='OK')
		{
			navigator.notification.alert(
				'Adicionado com sucesso.',  // message
				alertDismissed,         // callback
				'Success',            // title
				'OK'                  // buttonName
			);
			$('#exampleModal').hide();
			getPage('timetable',false);
		}
		else
		{
			navigator.notification.alert(
			'Não foi possível excluir.',  // message
					alertDismissed,         // callback
					'Warning',            // title
					'OK'                  // buttonName
			);	
		}
	});
	
	}
	else
	{
		navigator.notification.alert(
					'Check the field. The field is mandatory',  // message
					alertDismissed,         // callback
					'Warning',            // title
					'OK'                  // buttonName
				);	
	
	}

}


function deleteActivity(id)
{
	navigator.notification.confirm(
        'Are you sure you want to delete ',  // message
        onConfirmDeleteActivity,              // callback to invoke with index of button pressed
        'Delete',            // title
         ['yes','no']             // buttonLabels
    );

    function onConfirmDeleteActivity(buttonIndex)
	{
		if(buttonIndex==2)
		{

		}
		else
		{
			$.post("https://tempustecnologia.com/sulife/controller/exec.timetable.php",
			{
			  op: "E",
			  idtimetable: id
			},
			function(data,status){
				
				if (data.trim()=='OK')
				{
					navigator.notification.alert(
						'Excluído com sucesso.',  // message
						alertDismissed,         // callback
						'Success',            // title
						'OK'                  // buttonName
					);
					getPage('timetable',false);
					
				}
				else
				{
					navigator.notification.alert(
					'Não foi possível excluir.',  // message
							alertDismissed,         // callback
							'Warning',            // title
							'OK'                  // buttonName
					);	
				}
			});				

		}

	
	}




}


// SETTINS


	function getImageUser()
	{
		
		navigator.camera.getPicture(uploadPhotoUser, function(message) {
			alert('get picture failed');
		}, {
		quality: 25,
		destinationType: navigator.camera.DestinationType.FILE_URI,
		sourceType: navigator.camera.PictureSourceType.PHOTOLIBRARY

		});
		
	}

	function uploadPhotoUser(imageURI) {
		
		//alert(imageURI.substr(imageURI.lastIndexOf('/') + 1));
		var options = new FileUploadOptions();
		options.fileKey = "file";
		arquivo = leftPad(window.localStorage.getItem("iduser"),6)+'_'+imageURI.substr(imageURI.lastIndexOf('/') + 1)+'.jpg';
		options.fileName = arquivo;
		document.getElementById('edtpictureuser').value=arquivo;
		//options.fileName = imageURI.substr(imageURI.lastIndexOf('/') + 1);
		options.mimeType = "image/jpeg";
		console.log(options.fileName);
		var params = new Object();
		params.value1 = "test";
		params.value2 = "param";
		options.params = params;
		options.chunkedMode = false;

		var ft = new FileTransfer();
		ft.onprogress = function(progressEvent) {
			//alert(progressEvent.loaded);
			var p =  Math.round((progressEvent.loaded / progressEvent.total)*100);
			
			var progress = '';
			progress = '<div class="progress">';
			progress +='<div class="progress-bar bg-success" role="progressbar" style="width: '+p+'%;height:15px;" role="progressbar"> '+p+'% </div>';
			progress +='</div>';
			document.getElementById('progressbaruserpicture').innerHTML = progress;
			
			//document.getElementById('btn_camera_'+document.getElementById('idpedidoparaatendimento').value+'').value = progressEvent.loaded;
			
			//if (progressEvent.lengthComputable) {
		//		loadingStatus.setPercentage(progressEvent.loaded / progressEvent.total)*100;
		//	} else {
		//		loadingStatus.increment();
		//	}
			
		};
		//alert('imageURI:'+imageURI);
		ft.upload(imageURI, "https://www.tempustecnologia.com/sulife/uploadusers.php", function(result){
				//alert('3');

				navigator.notification.alert(
									'Image uploaded successfully.',  // message
									alertDismissed,         // callback
									'Atenção',            // title
									'OK'                  // buttonName
				);
				
				document.getElementById('img_user').src='https://tempustecnologia.com/sulife/picture/user/'+arquivo;
				document.getElementById('progressbaruserpicture').innerHTML = '';
				//getPage('followups',false);
				console.log(JSON.stringify(result));
		}, function(error){
				//alert(JSON.stringify(error));
				navigator.notification.alert(
									'Could not upload the image.',  // message
									alertDismissed,         // callback
									'Atenção',            // title
									'OK'                  // buttonName
				);
			console.log(JSON.stringify(error));
		}, options);
		
		
	}	

	
    </script>
</body>

</html>